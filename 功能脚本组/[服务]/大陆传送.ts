
import * as 地图 from '../../_核心部分/_地图/地图';



export function Main(Npc: TNormNpc, Player: TPlayObject, Args: TArgs): void {
    // 第三章,334,336
    // 第四章,176,327
    // 第五章,240,20
    // 第六章,143,334
    // 上古圣地,123,156
    // 第八章,334,336
    // 第九章,334,336
    // 第十章,334,336
    let S = ``
    switch (Npc.Tag) {
        case 1:
            S = `\\\\
            {S=第三章传送;C=22;X=150;Y=30}\\
            {S=满足下列条件可进入第三章:;C=19;X=25;Y=60}\\
            {S=1. 人物等级达到1050级;C=9;X=25;Y=80}\\
            {S=2. 斗笠等级达到100级;C=9;X=25;Y=100}\\
            {S=3. 佩戴[20级]职业专属;C=9;X=25;Y=120}\\
            {S=4. 佩戴[300级]及以上的玉帝之玺;C=9;X=25;Y=140}\\
            {S=完成以上要求奖励:;C=8;X=25;Y=160}{S=[第二章]成就;HINT=击杀任意怪物1/50几率增加元宝1-400点;C=46;Y=160}\\

            <{S=进入第三章;X=300;Y=220}/@进入(2)>
        
            `
            break;
        case 2:
            S = `\\\\
            {S=第四章传送;C=22;X=150;Y=30}\\
            {S=满足下列条件可进入第四章:;C=19;X=25;Y=60}\\
            {S=1. 人物等级达到2000级;C=9;X=25;Y=80}\\
            {S=2. 斗笠等级达到150级;C=9;X=25;Y=100}\\
            {S=3. 佩戴[40级]职业专属;C=9;X=25;Y=120}\\
            {S=4. 佩戴[30级]及以上的恶魔时装;C=9;X=25;Y=140}\\
            {S=完成以上要求奖励:;C=8;X=25;Y=160}{S=[第三章]成就;HINT=击杀任意怪物1/50几率增加元宝1-600点;C=46;Y=160}\\

            
            <{S=进入第四章;X=300;Y=220}/@进入(3)>

            `

            break;
        case 3:
            S = `\\\\
            {S=第五章传送;C=22;X=150;Y=30}\\
            {S=满足下列条件可进入第五章:;C=19;X=25;Y=60}\\
            {S=1. 人物等级达到3000级;C=9;X=25;Y=80}\\
            {S=2. 斗笠等级达到400级;C=9;X=25;Y=100}\\
            {S=3. 佩戴[50级]职业专属;C=9;X=25;Y=120}\\
            {S=4. 佩戴[50级]及以上的恶魔时装;C=9;X=25;Y=140}\\
            {S=5. 佩戴[500级]及以上的玉帝之玺;C=9;X=25;Y=160}\\
            {S=完成以上要求奖励:;C=8;X=25;Y=180}{S=[第四章]成就;HINT=击杀任意怪物1/50几率增加元宝1-800点;C=46;Y=180}\\

            <{S=进入第五章;X=300;Y=220}/@进入(4)>
                      
            `

            break;
        case 4:
            S = `\\\\
            {S=第六章传送;C=22;X=150;Y=30}\\
            {S=满足下列条件可进入第六章:;C=19;X=25;Y=60}\\
            {S=1. 人物等级达到4000级;C=9;X=25;Y=80}\\
            {S=2. 斗笠等级达到400级;C=9;X=25;Y=100}\\
            {S=3. 佩戴[10级]魔器裂天;C=9;X=25;Y=120}\\
            {S=完成以上要求奖励:;C=8;X=25;Y=160}{S=[第五章]成就;HINT=击杀任意怪物1/50几率增加元宝1-1000点;C=46;Y=160}\\

            <{S=进入第六章;X=300;Y=220}/@进入(5)>
            `
            break;
        case 5:
            S = `\\\\
            {S=第七章传送;C=22;X=150;Y=30}\\
            {S=满足下列条件可进入第七章:;C=19;X=25;Y=60}\\
            {S=1. 人物等级达到5000级;C=9;X=25;Y=80}\\
            {S=2. 斗笠等级达到600级;C=9;X=25;Y=100}\\
            {S=3. 佩戴[10级]魔器九霄;C=9;X=25;Y=120}\\
            {S=完成以上要求奖励:;C=8;X=25;Y=160}{S=[第六章]成就;HINT=击杀任意怪物1/50几率增加元宝1-1200点;C=46;Y=160}\\

            <{S=进入第七章;X=300;Y=220}/@进入(6)>
            `
            break;
        case 6:
            S = `\\\\
            {S=第八章传送;C=22;X=150;Y=30}\\
            {S=满足下列条件可进入第八章:;C=19;X=25;Y=60}\\
            {S=1. 人物等级达到6000级;C=9;X=25;Y=80}\\
            {S=2. 斗笠等级达到800级;C=9;X=25;Y=100}\\
            {S=3. 佩戴[10级]魔器朝夕;C=9;X=25;Y=120}\\
            {S=完成以上要求奖励:;C=8;X=25;Y=160}{S=[第七章]成就;HINT=击杀任意怪物1/50几率增加元宝1-1400点;C=46;Y=160}\\

            <{S=进入第八章;X=300;Y=220}/@进入(7)>
            `
            break;
        case 7:
            S = `\\\\
            {S=第九章传送;C=22;X=150;Y=30}\\
            {S=满足下列条件可进入第九章:;C=19;X=25;Y=60}\\
            {S=1. 人物等级达到7000级;C=9;X=25;Y=80}\\
            {S=2. 斗笠等级达到1000级;C=9;X=25;Y=100}\\
            {S=3. 圣墟等级达到1000级;C=9;X=25;Y=120}\\
            {S=完成以上要求奖励:;C=8;X=25;Y=160}{S=[第八章]成就;HINT=击杀任意怪物1/50几率增加元宝1-1600点;C=46;Y=160}\\

            <{S=进入第九章;X=300;Y=220}/@进入(8)>
            `
            break;
        case 8:
            S = `\\\\
            {S=第十章传送;C=22;X=150;Y=30}\\
            {S=满足下列条件可进入第十章:;C=19;X=25;Y=60}\\
            {S=1. 人物等级达到8000级;C=9;X=25;Y=80}\\
            {S=2. 斗笠等级达到1200级;C=9;X=25;Y=100}\\
            {S=3. 佩戴[10级]魔器朝夕;C=9;X=25;Y=120}\\
            {S=完成以上要求奖励:;C=8;X=25;Y=160}{S=[第九章]成就;HINT=击杀任意怪物1/50几率增加元宝1-1800点;C=46;Y=160}\\

            <{S=进入第十章;X=300;Y=220}/@进入(9)>
            `
            break;
        default:
            S = `\\\\
            {S=第二章传送;C=22;X=150;Y=30}\\
            {S=满足一下条件可进入第二章:;C=19;X=25;Y=60}\\
            {S=1. 人物等级达到500级;C=9;X=25;Y=80}\\
            {S=2. 转生等级达到30级;C=9;X=25;Y=100}\\
            {S=3. 佩戴[5级]职业专属;C=9;X=25;Y=120}\\
            {S=4. 佩戴[80级]及以上的玉帝之玺;C=9;X=25;Y=140}\\
            {S=完成以上要求奖励:;C=8;X=25;Y=160}{S=[第一章]成就;HINT=击杀任意怪物1/50几率增加元宝1-200点;C=46;Y=160}\\

            <{S=进入第二章;X=300;Y=220}/@进入(1)>
    `
            break;
    }
    Npc.SayEx(Player, 'NPC小窗口', S)
}


// 大陆传送配置接口
interface 大陆传送配置 {
    大陆编号: number;
    大陆名称: string;
    传送坐标: { x: number; y: number };
    需求条件: {
        人物等级: number;
        转生等级?: number;
        专属等级: number;
        玉帝之玺等级: number;
        斗笠等级?: number;
        恶魔时装等级?: number;
        魔器裂天等级?: number;
        魔器九霄等级?: number;
        魔器朝夕等级?: number;
    };
    成就设置: {
        设置成就: string;
        清除成就?: string;
    };
}

// 大陆传送配置表
const 大陆传送配置表: 大陆传送配置[] = [
    {
        大陆编号: 1,
        大陆名称: '第二章',
        传送坐标: { x: 41, y: 55 },
        需求条件: {
            人物等级: 500,
            转生等级: 30,
            专属等级: 5,
            玉帝之玺等级: 80
        },
        成就设置: {
            设置成就: '第一章成就',
            清除成就: '第二章成就'
        }
    },
    {
        大陆编号: 2,
        大陆名称: '第三章',
        传送坐标: { x: 331, y: 337 },
        需求条件: {
            人物等级: 1050,
            专属等级: 20,
            玉帝之玺等级: 300,
            斗笠等级: 100
        },
        成就设置: {
            设置成就: '第二章成就',
            清除成就: '第一章成就'
        }
    },
    {
        大陆编号: 3,
        大陆名称: '第四章',
        传送坐标: { x: 176, y: 327 },
        需求条件: {
            人物等级: 2000,
            专属等级: 40,
            玉帝之玺等级: 80,
            斗笠等级: 150,
            恶魔时装等级: 30
        },
        成就设置: {
            设置成就: '第三章成就',
            清除成就: '第二章成就'
        }
    },
    {
        大陆编号: 4,
        大陆名称: '第五章',
        传送坐标: { x: 240, y: 200 },
        需求条件: {
            人物等级: 3000,
            专属等级: 50,
            玉帝之玺等级: 500,
            斗笠等级: 400,
            恶魔时装等级: 50
        },
        成就设置: {
            设置成就: '第四章成就',
            清除成就: '第三章成就'
        }
    },
    {
        大陆编号: 5,
        大陆名称: '第六章',
        传送坐标: { x: 90, y: 110 },
        需求条件: {
            人物等级: 4000,
            专属等级: 10,
            玉帝之玺等级: 500,
            斗笠等级: 600,
            魔器裂天等级: 10
        },
        成就设置: {
            设置成就: '第五章成就',
            清除成就: '第四章成就'
        }
    },
    {
        大陆编号: 6,
        大陆名称: '第七章',
        传送坐标: { x: 123, y: 156 },
        需求条件: {
            人物等级: 5000,
            专属等级: 10,
            玉帝之玺等级: 500,
            斗笠等级: 600,
            魔器九霄等级: 10
        },
        成就设置: {
            设置成就: '第六章成就',
            清除成就: '第五章成就'
        }
    },
    {
        大陆编号: 7,
        大陆名称: '第八章',
        传送坐标: { x: 41, y: 55 },
        需求条件: {
            人物等级: 6000,
            专属等级: 10,
            玉帝之玺等级: 500,
            斗笠等级: 1000,
            魔器朝夕等级: 10
        },
        成就设置: {
            设置成就: '第七章成就',
            清除成就: '第六章成就'
        }
    },
    {
        大陆编号: 8,
        大陆名称: '第九章',
        传送坐标: { x: 41, y: 55 },
        需求条件: {
            人物等级: 70000,
            专属等级: 10,
            玉帝之玺等级: 500,
            斗笠等级: 1200
        },
        成就设置: {
            设置成就: '第八章成就',
            清除成就: '第七章成就'
        }
    },
];

// 统一的进入函数
export function 进入(Npc: TNormNpc, Player: TPlayObject, Args: TArgs): void {
    const 大陆 = Args.Int[0];
    const 配置 = 大陆传送配置表.find(config => config.大陆编号 === 大陆);

    if (!配置) {
        Player.MessageBox('无效的大陆编号！');
        return;
    }

    // 检查职业专属
    if (配置.需求条件.专属等级 && Player.Bujuk == null) {
        Player.MessageBox('请佩戴职业专属');
        return;
    }

    // 检查玉帝之玺
    if (配置.需求条件.玉帝之玺等级 && Player.GetJewelrys(0) == null) {
        Player.MessageBox('请佩戴玉帝之玺');
        return;
    }

    // 检查斗笠（如果需要）
    if (配置.需求条件.斗笠等级 && Player.Mask == null) {
        Player.MessageBox('请佩戴斗笠');
        return;
    }

    // 检查恶魔时装（如果需要）
    if (配置.需求条件.恶魔时装等级 && Player.Fashion == null) {
        Player.MessageBox('请佩戴恶魔时装');
        return;
    }

    // 获取装备等级
    const 专属装备 = Player.Bujuk.DisplayName;
    const 玉帝之玺 = Player.GetJewelrys(0).DisplayName;
    const 斗笠 = Player.Mask?.DisplayName;
    const 恶魔时装 = Player.Fashion?.DisplayName;
    const 魔器裂天 = Player.GetZodiacs(1)?.DisplayName;
    const 魔器九霄 = Player.GetZodiacs(7)?.DisplayName;
    const 魔器朝夕 = Player.GetZodiacs(11)?.DisplayName;
    // 检查专属等级
    if (专属装备) {
        const 专属等级匹配 = 专属装备.match(/『(\d+)级』/);
        if (专属等级匹配) {
            const 专属等级 = Number(专属等级匹配[1]);
            if (专属等级 < 配置.需求条件.专属等级) {
                Player.MessageBox(`职业专属不足${配置.需求条件.专属等级}级`);
                return;
            }
        } else {
            Player.MessageBox(`职业专属不足${配置.需求条件.专属等级}级`);
            return;
        }
    }

    // 检查玉帝之玺等级
    if (玉帝之玺) {
        const 玉帝之玺等级匹配 = 玉帝之玺.match(/『(\d+)级』/);
        if (玉帝之玺等级匹配) {
            const 玉帝之玺等级 = Number(玉帝之玺等级匹配[1]);
            if (玉帝之玺等级 < 配置.需求条件.玉帝之玺等级) {
                Player.MessageBox(`玉帝之玺不足${配置.需求条件.玉帝之玺等级}级`);
                return;
            }
        } else {
            Player.MessageBox(`玉帝之玺不足${配置.需求条件.玉帝之玺等级}级`);
            return;
        }
    }

    // 检查斗笠等级（如果需要）
    if (配置.需求条件.斗笠等级 && 斗笠) {
        const 斗笠等级匹配 = 斗笠.match(/『(\d+)级』/);
        if (斗笠等级匹配) {
            const 斗笠等级 = Number(斗笠等级匹配[1]);
            if (斗笠等级 < 配置.需求条件.斗笠等级) {
                Player.MessageBox(`斗笠不足${配置.需求条件.斗笠等级}级`);
                return;
            }
        } else {
            Player.MessageBox(`斗笠不足${配置.需求条件.斗笠等级}级`);
            return;
        }
    }
    if (配置.需求条件.恶魔时装等级 && 恶魔时装) {
        const 恶魔时装等级匹配 = 恶魔时装.match(/『(\d+)级』/);
        if (恶魔时装等级匹配) {
            const 恶魔时装等级 = Number(恶魔时装等级匹配[1]);
            if (恶魔时装等级 < 配置.需求条件.恶魔时装等级) {
                Player.MessageBox(`恶魔时装不足${配置.需求条件.恶魔时装等级}级`);
                return;
            }
        } else {
            Player.MessageBox(`恶魔时装不足${配置.需求条件.恶魔时装等级}级`);
            return;
        }
    }


    // 检查魔器裂天等级（如果需要）
    if (配置.需求条件.魔器裂天等级) {
        if (!魔器裂天) {
            // 没有佩戴魔器裂天
            Player.MessageBox('请佩戴魔器裂天');
            return;
        } else {
            // 有佩戴，检查等级
            const 魔器裂天等级匹配 = 魔器裂天.match(/『(\d+)级』/);
            if (魔器裂天等级匹配) {
                const 魔器裂天等级 = Number(魔器裂天等级匹配[1]);
                if (魔器裂天等级 < 配置.需求条件.魔器裂天等级) {
                    Player.MessageBox(`魔器裂天不足${配置.需求条件.魔器裂天等级}级`);
                    return;
                }
            } else {
                // 有装备但无法识别等级，视为不符合要求
                Player.MessageBox(`魔器裂天不足${配置.需求条件.魔器裂天等级}级`);
                return;
            }
        }
    }
    // 检查魔器九霄等级（如果需要）
    if (配置.需求条件.魔器九霄等级) {
        if (!魔器九霄) {
            Player.MessageBox('请佩戴魔器九霄');
            return;
        } else {
            const 魔器九霄等级匹配 = 魔器九霄.match(/『(\d+)级』/);
            if (魔器九霄等级匹配) {
                const 魔器九霄等级 = Number(魔器九霄等级匹配[1]);
                if (魔器九霄等级 < 配置.需求条件.魔器九霄等级) {
                    Player.MessageBox(`魔器九霄不足${配置.需求条件.魔器九霄等级}级`);
                    return;
                }
            } else {
                Player.MessageBox(`魔器九霄不足${配置.需求条件.魔器九霄等级}级`);
                return;
            }
        }
    }

    if (配置.需求条件.魔器朝夕等级) {
        if (!魔器朝夕) {
            Player.MessageBox('请佩戴魔器朝夕');
            return;
        } else {
            const 魔器朝夕等级匹配 = 魔器朝夕.match(/『(\d+)级』/);
            if (魔器朝夕等级匹配) {
                const 魔器朝夕等级 = Number(魔器朝夕等级匹配[1]);
                if (魔器朝夕等级 < 配置.需求条件.魔器朝夕等级) {
                    Player.MessageBox(`魔器朝夕不足${配置.需求条件.魔器朝夕等级}级`);
                    return;
                }
            } else {
                Player.MessageBox(`魔器朝夕不足${配置.需求条件.魔器朝夕等级}级`);
                return;
            }
        }
    }


    // 检查人物等级
    if (Player.GetLevel() < 配置.需求条件.人物等级) {
        Player.MessageBox(`人物等级不足${配置.需求条件.人物等级}级`);
        return;
    }

    // 检查转生等级（如果需要）
    if (配置.需求条件.转生等级 && Player.GetReNewLevel() < 配置.需求条件.转生等级) {
        Player.MessageBox(`转生等级不足${配置.需求条件.转生等级}级`);
        return;
    }

    // 设置成就
    if (配置.成就设置.设置成就) {
        Player.V[配置.成就设置.设置成就] = true;
    }
    if (配置.成就设置.清除成就) {
        delete Player.V[配置.成就设置.清除成就]
    }


    // 传送到目标大陆
    Player.MapMove(配置.大陆名称, 配置.传送坐标.x, 配置.传送坐标.y);
}

// // 保留原有函数名以保持兼容性
// export function 进入第二章(Npc: TNormNpc, Player: TPlayObject, Args: TArgs): void {
//     Args.Int[0] = 1;
//     进入(Npc, Player, Args);
// }

// export function 进入第三章(Npc: TNormNpc, Player: TPlayObject, Args: TArgs): void {
//     Args.Int[0] = 2;
//     进入(Npc, Player, Args);
// }

// export function 进入第四章(Npc: TNormNpc, Player: TPlayObject, Args: TArgs): void {
//     Args.Int[0] = 3;
//     进入(Npc, Player, Args);
// }

// export function 进入第五章(Npc: TNormNpc, Player: TPlayObject, Args: TArgs): void {
//     Args.Int[0] = 4;
//     进入(Npc, Player, Args);
// }

// export function 进入第六章(Npc: TNormNpc, Player: TPlayObject, Args: TArgs): void {
//     Args.Int[0] = 5;
//     进入(Npc, Player, Args);
// }


export function 地图成就(Npc: TNormNpc, Player: TPlayObject, Args: TArgs): void {
    Player.V.地图成就 ??= 0
    // 查找匹配的怪物配置
    let 成就等级 = Player.V.地图成就 + 1
    const 地图成就配置 = 地图成就表.find(config => config.成就等级 === 成就等级);

    let S = ``
    S = `\\\\

{S=地图成就;C=#FF3366;X=162;Y=30}

{S=成就介绍:;C=#0099FF;X=25;Y=50}

{S=完成相应的地图成就,杀怪时可随机获得1-5元宝;C=#FFCC00;X=25;Y=75}

{S=成就每提高一级,获得元宝上限 + 5;C=#FFCC00;X=25;Y=100}

{S=完成需求:;C=#33CCFF;X=25;Y=130}

{S=击杀对应地图的BOSS怪可获得材料.;C=#FFCC00;X=25;Y=155}

{S=当前成就:;C=#33CCFF;X=25;Y=180}
{S=${地图成就配置?.地图名称 || '已达到最高等级'};C=#FFCC00;X=80;Y=180}
{S=需求数量:;C=#33CCFF;X=25;Y=200}
{S=${地图成就配置?.需求数量 || '无'} ;C=#FFCC00;X=80;Y=200}

<{S=地图成就提高;X=300;Y=220}/@地图成就提高>
`
    // Player.V.地图成就 = 100
    Npc.SayEx(Player, 'NPC小窗口', S)
}

// 怪物掉落配置接口
interface 地图成就配置 {
    成就等级: number;  // 成就等级
    地图名称: string;  // 地图名称
    需求数量: number;  // 需求数量
}

const 地图成就表: 地图成就配置[] = [
    { 成就等级: 1, 地图名称: '荒芜山谷', 需求数量: 10 },
    { 成就等级: 2, 地图名称: '试炼之地', 需求数量: 20 },
    { 成就等级: 3, 地图名称: '血之炼狱', 需求数量: 30 },
    { 成就等级: 4, 地图名称: '竞技洞窟', 需求数量: 40 },
    { 成就等级: 5, 地图名称: '血路之颠', 需求数量: 50 },
    { 成就等级: 6, 地图名称: '沙漠绿洲', 需求数量: 60 },
    { 成就等级: 7, 地图名称: '凄凉之地', 需求数量: 70 },
    { 成就等级: 8, 地图名称: '狂风峭壁', 需求数量: 80 },
    { 成就等级: 9, 地图名称: '崎岖索道', 需求数量: 90 },
    { 成就等级: 10, 地图名称: '风暴峡谷', 需求数量: 100 },
    { 成就等级: 11, 地图名称: '古船遗迹', 需求数量: 110 },
    { 成就等级: 12, 地图名称: '森林迷宫', 需求数量: 120 },
    { 成就等级: 13, 地图名称: '古之城墙', 需求数量: 130 },
    { 成就等级: 14, 地图名称: '暗影迷宫', 需求数量: 140 },
    { 成就等级: 15, 地图名称: '失落暗殿', 需求数量: 150 },
    { 成就等级: 16, 地图名称: '神秘古国', 需求数量: 160 },
    { 成就等级: 17, 地图名称: '海岛遗迹', 需求数量: 170 },
    { 成就等级: 18, 地图名称: '魔之莽道', 需求数量: 180 },
    { 成就等级: 19, 地图名称: '盘蛇古迹', 需求数量: 190 },
    { 成就等级: 20, 地图名称: '泗水祭坛', 需求数量: 200 },
    { 成就等级: 21, 地图名称: '铁血魔域', 需求数量: 210 },
    { 成就等级: 22, 地图名称: '血腥森林', 需求数量: 220 },
    { 成就等级: 23, 地图名称: '蛮荒丛林', 需求数量: 230 },
    { 成就等级: 24, 地图名称: '血狱皇陵', 需求数量: 240 },
    { 成就等级: 25, 地图名称: '星空廊道', 需求数量: 250 },
    { 成就等级: 26, 地图名称: '黑暗森林', 需求数量: 260 },
    { 成就等级: 27, 地图名称: '郊外平原', 需求数量: 270 },
    { 成就等级: 28, 地图名称: '天然洞穴', 需求数量: 280 },
    { 成就等级: 29, 地图名称: '矿区山谷', 需求数量: 290 },
    { 成就等级: 30, 地图名称: '祖玛回廊', 需求数量: 300 },
    { 成就等级: 31, 地图名称: '万妖森林', 需求数量: 310 },
    { 成就等级: 32, 地图名称: '万妖峡谷', 需求数量: 320 },
    { 成就等级: 33, 地图名称: '万妖之巢', 需求数量: 330 },
    { 成就等级: 34, 地图名称: '万妖迷宫', 需求数量: 340 },
    { 成就等级: 35, 地图名称: '万妖祭坛', 需求数量: 350 },
    { 成就等级: 36, 地图名称: '邪恶洞穴', 需求数量: 360 },
    { 成就等级: 37, 地图名称: '蛇妖山谷', 需求数量: 370 },
    { 成就等级: 38, 地图名称: '沃玛寺庙', 需求数量: 380 },
    { 成就等级: 39, 地图名称: '暗黑蛇谷', 需求数量: 390 },
    { 成就等级: 40, 地图名称: '沉息之地', 需求数量: 400 },
    { 成就等级: 41, 地图名称: '神域冰谷', 需求数量: 410 },
    { 成就等级: 42, 地图名称: '纷争之地', 需求数量: 420 },
    { 成就等级: 43, 地图名称: '上古禁地', 需求数量: 430 },
    { 成就等级: 44, 地图名称: '封印之城', 需求数量: 440 },
    { 成就等级: 45, 地图名称: '神庙主殿', 需求数量: 450 },

]

export function 地图成就提高(Npc: TNormNpc, Player: TPlayObject, Args: TArgs): void {
    let 成就等级 = Player.V.地图成就 + 1
    const 地图成就配置 = 地图成就表.find(config => config.成就等级 === 成就等级);

    if (Player.GetItemCount(地图成就配置?.地图名称) < 地图成就配置?.需求数量) {
        Player.MessageBox(`{S=${地图成就配置?.地图名称};C=253} 材料不足,无法提高成就!`)
        return
    }
    Npc.Take(Player, 地图成就配置?.地图名称, 地图成就配置?.需求数量)
    Player.V.地图成就 = Player.V.地图成就 + 1
    Player.MessageBox(`地图成就提高成功,当前成就:${Player.V.地图成就}`)
    地图成就(Npc, Player, Args)
}