
/**
 * 智能刷怪机器人模块 - 已优化版本
 * 
 * 主要修复内容：
 * 1. 改进地图查找机制 - 多重查找方式确保地图能被正确找到
 * 2. 增强人数检测可靠性 - 添加异常处理和容错机制  
 * 3. 优化地图状态管理 - 更安全的状态同步
 * 4. 添加缓存机制 - 减少重复查找提高性能
 * 5. 增加调试模式 - 便于问题排查
 * 
 * 解决的问题：
 * - 个别玩家在地图但不刷怪的情况
 * - 地图查找失败导致的刷怪中断
 * - 人数检测不准确的边界情况
 * - 地图状态同步延迟问题
 */

import * as 地图 from '../[地图]/地图';


const 小怪刷新 = 4
const 精英刷新 = 4
const BOSS刷新 = 6

// 调试模式开关 - 可通过设置 GameLib.R.刷怪调试模式 = true 来启用
const 调试模式 = GameLib.R?.刷怪调试模式 || false

// 地图查找缓存
const 地图缓存: { [key: string]: TEnvirnoment | null } = {}
const 缓存过期时间 = 5 * 60 * 1000 // 5分钟过期
const 缓存时间戳: { [key: string]: number } = {}



const 智能刷怪 = [
    { 地图名字: '荒芜山谷', 地图名字变量: '空', 怪物名字: '鸡', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '荒芜山谷', 地图名字变量: '空', 怪物名字: '鹿', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '荒芜山谷', 地图名字变量: '空', 怪物名字: '肥羊', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '荒芜山谷', 地图名字变量: '空', 怪物名字: '稻草人', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '荒芜山谷', 地图名字变量: '空', 怪物名字: '多钩猫', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '荒芜山谷', 地图名字变量: '空', 怪物名字: '钉耙猫', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '荒芜山谷', 地图名字变量: '空', 怪物名字: '毒蜘蛛', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '荒芜山谷', 地图名字变量: '空', 怪物名字: '猎鹰', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '荒芜山谷', 地图名字变量: '荒芜山谷', 怪物名字: '大尾狐狸', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '试炼之地', 地图名字变量: '空', 怪物名字: '粪虫', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '试炼之地', 地图名字变量: '空', 怪物名字: '洞蛆', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '试炼之地', 地图名字变量: '空', 怪物名字: '骷髅', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '试炼之地', 地图名字变量: '空', 怪物名字: '掷斧骷髅', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '试炼之地', 地图名字变量: '空', 怪物名字: '骷髅战士', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '试炼之地', 地图名字变量: '空', 怪物名字: '骷髅战将', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '试炼之地', 地图名字变量: '空', 怪物名字: '毒骷髅', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '试炼之地', 地图名字变量: '空', 怪物名字: '骷髅精灵', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '试炼之地', 地图名字变量: '试炼之地', 怪物名字: '骨龙精灵', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '血之炼狱', 地图名字变量: '空', 怪物名字: '红僵', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '血之炼狱', 地图名字变量: '空', 怪物名字: '黑僵', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '血之炼狱', 地图名字变量: '空', 怪物名字: '电僵王', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '血之炼狱', 地图名字变量: '空', 怪物名字: '闪电僵尸', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '血之炼狱', 地图名字变量: '空', 怪物名字: '僵尸王', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '血之炼狱', 地图名字变量: '空', 怪物名字: '血僵尸', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '血之炼狱', 地图名字变量: '空', 怪物名字: '尸王', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '血之炼狱', 地图名字变量: '空', 怪物名字: '奢比', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '血之炼狱', 地图名字变量: '血之炼狱', 怪物名字: '凶悍屠夫', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '竞技洞窟', 地图名字变量: '空', 怪物名字: '蜈蚣', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '竞技洞窟', 地图名字变量: '空', 怪物名字: '黑色恶蛆', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '竞技洞窟', 地图名字变量: '空', 怪物名字: '蝎子', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '竞技洞窟', 地图名字变量: '空', 怪物名字: '巨型蠕虫', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '竞技洞窟', 地图名字变量: '空', 怪物名字: '半兽人', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '竞技洞窟', 地图名字变量: '空', 怪物名字: '半兽战士', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '竞技洞窟', 地图名字变量: '空', 怪物名字: '半兽勇士', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '竞技洞窟', 地图名字变量: '空', 怪物名字: '半兽统领', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '竞技洞窟', 地图名字变量: '竞技洞窟', 怪物名字: '恶魔教主', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '血路之颠', 地图名字变量: '空', 怪物名字: '多角虫', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '血路之颠', 地图名字变量: '空', 怪物名字: '巨型多角虫', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '血路之颠', 地图名字变量: '空', 怪物名字: '双头金刚', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '血路之颠', 地图名字变量: '空', 怪物名字: '双头血魔', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '血路之颠', 地图名字变量: '空', 怪物名字: '变异双头血魔', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '血路之颠', 地图名字变量: '空', 怪物名字: '变异双头金刚', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '血路之颠', 地图名字变量: '空', 怪物名字: '暗之双头血魔', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '血路之颠', 地图名字变量: '空', 怪物名字: '暗之双头金刚', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '血路之颠', 地图名字变量: '血路之颠', 怪物名字: '赤月恶魔', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '沙漠绿洲', 地图名字变量: '空', 怪物名字: '猎鹰', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '沙漠绿洲', 地图名字变量: '空', 怪物名字: '红蛇', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '沙漠绿洲', 地图名字变量: '空', 怪物名字: '虎蛇', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '沙漠绿洲', 地图名字变量: '空', 怪物名字: '毒蜘蛛', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '沙漠绿洲', 地图名字变量: '空', 怪物名字: '暴牙蜘蛛', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '沙漠绿洲', 地图名字变量: '空', 怪物名字: '月魔蜘蛛', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '沙漠绿洲', 地图名字变量: '空', 怪物名字: '蛇妖战士', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '沙漠绿洲', 地图名字变量: '空', 怪物名字: '变异蛇妖', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '沙漠绿洲', 地图名字变量: '沙漠绿洲', 怪物名字: '金色眼镜蛇', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '凄凉之地', 地图名字变量: '空', 怪物名字: '多钩猫王', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '凄凉之地', 地图名字变量: '空', 怪物名字: '钉耙猫王', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '凄凉之地', 地图名字变量: '空', 怪物名字: '红蛇王', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '凄凉之地', 地图名字变量: '空', 怪物名字: '虎蛇王', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '凄凉之地', 地图名字变量: '空', 怪物名字: '红野猪', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '凄凉之地', 地图名字变量: '空', 怪物名字: '黑野猪', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '凄凉之地', 地图名字变量: '空', 怪物名字: '僵尸王', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '凄凉之地', 地图名字变量: '空', 怪物名字: '黑暗巨锤', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '凄凉之地', 地图名字变量: '凄凉之地', 怪物名字: '丛林守护者', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '狂风峭壁', 地图名字变量: '空', 怪物名字: '钢牙蜘蛛', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '狂风峭壁', 地图名字变量: '空', 怪物名字: '花吻蜘蛛', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '狂风峭壁', 地图名字变量: '空', 怪物名字: '暗黑战士', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '狂风峭壁', 地图名字变量: '空', 怪物名字: '沃玛战士', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '狂风峭壁', 地图名字变量: '空', 怪物名字: '沃玛勇士', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '狂风峭壁', 地图名字变量: '空', 怪物名字: '火焰沃玛', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '狂风峭壁', 地图名字变量: '空', 怪物名字: '沃玛卫士', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '狂风峭壁', 地图名字变量: '空', 怪物名字: '沃玛教主', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '狂风峭壁', 地图名字变量: '狂风峭壁', 怪物名字: '沃玛统治者', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '崎岖索道', 地图名字变量: '空', 怪物名字: '跳跳蜂王', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '崎岖索道', 地图名字变量: '空', 怪物名字: '雪蚕王', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '崎岖索道', 地图名字变量: '空', 怪物名字: '蝎子王', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '崎岖索道', 地图名字变量: '空', 怪物名字: '钢牙蜘蛛', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '崎岖索道', 地图名字变量: '空', 怪物名字: '蝎蛇', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '崎岖索道', 地图名字变量: '空', 怪物名字: '钳虫', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '崎岖索道', 地图名字变量: '空', 怪物名字: '邪恶钳虫', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '崎岖索道', 地图名字变量: '空', 怪物名字: '白野猪', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '崎岖索道', 地图名字变量: '崎岖索道', 怪物名字: '恶魔飞虫', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '风暴峡谷', 地图名字变量: '空', 怪物名字: '地狱犬', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '风暴峡谷', 地图名字变量: '空', 怪物名字: '沙虫', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '风暴峡谷', 地图名字变量: '空', 怪物名字: '蜈蚣王', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '风暴峡谷', 地图名字变量: '空', 怪物名字: '盔甲虫', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '风暴峡谷', 地图名字变量: '空', 怪物名字: '大老鼠', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '风暴峡谷', 地图名字变量: '空', 怪物名字: '神鹰', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '风暴峡谷', 地图名字变量: '空', 怪物名字: '幽冥雕像', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '风暴峡谷', 地图名字变量: '空', 怪物名字: '幽冥卫士', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '风暴峡谷', 地图名字变量: '风暴峡谷', 怪物名字: '奇美拉', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '古船遗迹', 地图名字变量: '空', 怪物名字: '蜈蚣', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '古船遗迹', 地图名字变量: '空', 怪物名字: '黑色恶蛆', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '古船遗迹', 地图名字变量: '空', 怪物名字: '钳虫', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '古船遗迹', 地图名字变量: '空', 怪物名字: '跳跳蜂', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '古船遗迹', 地图名字变量: '空', 怪物名字: '楔蛾', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '古船遗迹', 地图名字变量: '空', 怪物名字: '钳虫', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '古船遗迹', 地图名字变量: '空', 怪物名字: '邪恶钳虫', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '古船遗迹', 地图名字变量: '空', 怪物名字: '触龙神', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '古船遗迹', 地图名字变量: '古船遗迹', 怪物名字: '巨型食人花', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '森林迷宫', 地图名字变量: '空', 怪物名字: '黑色恶蛆', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '森林迷宫', 地图名字变量: '空', 怪物名字: '蜈蚣', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '森林迷宫', 地图名字变量: '空', 怪物名字: '红野猪', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '森林迷宫', 地图名字变量: '空', 怪物名字: '黑野猪', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '森林迷宫', 地图名字变量: '空', 怪物名字: '楔蛾', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '森林迷宫', 地图名字变量: '空', 怪物名字: '蝎蛇', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '森林迷宫', 地图名字变量: '空', 怪物名字: '邪恶毒蛇', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '森林迷宫', 地图名字变量: '空', 怪物名字: '白野猪', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '森林迷宫', 地图名字变量: '森林迷宫', 怪物名字: '石墓之主', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '古之城墙', 地图名字变量: '空', 怪物名字: '楔蛾', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '古之城墙', 地图名字变量: '空', 怪物名字: '蝎蛇', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '古之城墙', 地图名字变量: '空', 怪物名字: '大老鼠', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '古之城墙', 地图名字变量: '空', 怪物名字: '祖玛雕像', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '古之城墙', 地图名字变量: '空', 怪物名字: '祖玛卫士', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '古之城墙', 地图名字变量: '空', 怪物名字: '祖玛弓箭手', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '古之城墙', 地图名字变量: '空', 怪物名字: '祖玛统领', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '古之城墙', 地图名字变量: '空', 怪物名字: '祖玛教主', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '古之城墙', 地图名字变量: '古之城墙', 怪物名字: '祖玛教皇', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '暗影迷宫', 地图名字变量: '空', 怪物名字: '月魔蜘蛛', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '暗影迷宫', 地图名字变量: '空', 怪物名字: '暴牙蜘蛛', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '暗影迷宫', 地图名字变量: '空', 怪物名字: '黑锷蜘蛛', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '暗影迷宫', 地图名字变量: '空', 怪物名字: '天狼蜘蛛', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '暗影迷宫', 地图名字变量: '空', 怪物名字: '血僵尸', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '暗影迷宫', 地图名字变量: '空', 怪物名字: '邪恶巨人', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '暗影迷宫', 地图名字变量: '空', 怪物名字: '双头金刚', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '暗影迷宫', 地图名字变量: '空', 怪物名字: '赤月恶魔', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '暗影迷宫', 地图名字变量: '暗影迷宫', 怪物名字: '赤月之王', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '失落暗殿', 地图名字变量: '空', 怪物名字: '血僵尸', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '失落暗殿', 地图名字变量: '空', 怪物名字: '花吻蜘蛛', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '失落暗殿', 地图名字变量: '空', 怪物名字: '钢牙蜘蛛', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '失落暗殿', 地图名字变量: '空', 怪物名字: '邪恶巨人', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '失落暗殿', 地图名字变量: '空', 怪物名字: '双头血魔', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '失落暗殿', 地图名字变量: '空', 怪物名字: '万妖法师', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '失落暗殿', 地图名字变量: '空', 怪物名字: '妖族巫师', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '失落暗殿', 地图名字变量: '空', 怪物名字: '万妖统领', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '失落暗殿', 地图名字变量: '失落暗殿', 怪物名字: '万妖之王', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '神秘古国', 地图名字变量: '空', 怪物名字: '黑色恶蛆', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '神秘古国', 地图名字变量: '空', 怪物名字: '钳虫', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '神秘古国', 地图名字变量: '空', 怪物名字: '大老鼠', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '神秘古国', 地图名字变量: '空', 怪物名字: '血僵尸', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '神秘古国', 地图名字变量: '空', 怪物名字: '蝎蛇', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '神秘古国', 地图名字变量: '空', 怪物名字: '邪恶毒蛇', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '神秘古国', 地图名字变量: '空', 怪物名字: '虹魔蝎卫', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '神秘古国', 地图名字变量: '空', 怪物名字: '虹魔猪卫', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '神秘古国', 地图名字变量: '神秘古国', 怪物名字: '虹魔教主', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '海岛遗迹', 地图名字变量: '空', 怪物名字: '恶狼', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '海岛遗迹', 地图名字变量: '空', 怪物名字: '猎鹰', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '海岛遗迹', 地图名字变量: '空', 怪物名字: '万妖小妖', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '海岛遗迹', 地图名字变量: '空', 怪物名字: '地螺刀手', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '海岛遗迹', 地图名字变量: '空', 怪物名字: '万妖法师', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '海岛遗迹', 地图名字变量: '空', 怪物名字: '暗之骷髅精灵', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '海岛遗迹', 地图名字变量: '空', 怪物名字: '妖族巫师', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '海岛遗迹', 地图名字变量: '空', 怪物名字: '万妖统领', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '海岛遗迹', 地图名字变量: '海岛遗迹', 怪物名字: '变异蝎妖', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '魔之莽道', 地图名字变量: '空', 怪物名字: '盔甲虫', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '魔之莽道', 地图名字变量: '空', 怪物名字: '多角虫', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '魔之莽道', 地图名字变量: '空', 怪物名字: '地狱喽啰', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '魔之莽道', 地图名字变量: '空', 怪物名字: '恶魔弓箭手', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '魔之莽道', 地图名字变量: '空', 怪物名字: '恶魔雕像', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '魔之莽道', 地图名字变量: '空', 怪物名字: '恶魔卫士', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '魔之莽道', 地图名字变量: '空', 怪物名字: '恶魔统领', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '魔之莽道', 地图名字变量: '空', 怪物名字: '恶魔主将', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '魔之莽道', 地图名字变量: '魔之莽道', 怪物名字: '恶魔教主', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '盘蛇古迹', 地图名字变量: '空', 怪物名字: '恶狼', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '盘蛇古迹', 地图名字变量: '空', 怪物名字: '猎鹰', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '盘蛇古迹', 地图名字变量: '空', 怪物名字: '地狱喽啰', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '盘蛇古迹', 地图名字变量: '空', 怪物名字: '铁血战士', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '盘蛇古迹', 地图名字变量: '空', 怪物名字: '墓地骷髅', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '盘蛇古迹', 地图名字变量: '空', 怪物名字: '恶魔刀手', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '盘蛇古迹', 地图名字变量: '空', 怪物名字: '铁血幻灵', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '盘蛇古迹', 地图名字变量: '空', 怪物名字: '变异蝎妖', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '盘蛇古迹', 地图名字变量: '盘蛇古迹', 怪物名字: '铁血媚妖', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '泗水祭坛', 地图名字变量: '空', 怪物名字: '盔甲虫', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '泗水祭坛', 地图名字变量: '空', 怪物名字: '多角虫', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '泗水祭坛', 地图名字变量: '空', 怪物名字: '巨型多角虫', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '泗水祭坛', 地图名字变量: '空', 怪物名字: '千年树妖', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '泗水祭坛', 地图名字变量: '空', 怪物名字: '暗之骷髅精灵', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '泗水祭坛', 地图名字变量: '空', 怪物名字: '恶魔统领', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '泗水祭坛', 地图名字变量: '空', 怪物名字: '恶魔主将', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '泗水祭坛', 地图名字变量: '空', 怪物名字: '恶魔教主', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '泗水祭坛', 地图名字变量: '泗水祭坛', 怪物名字: '铁血幻灵', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '铁血魔域', 地图名字变量: '空', 怪物名字: '威思而小虫', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '铁血魔域', 地图名字变量: '空', 怪物名字: '跳跳蜂王', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '铁血魔域', 地图名字变量: '空', 怪物名字: '恶灵僵尸', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '铁血魔域', 地图名字变量: '空', 怪物名字: '恶灵弓箭手', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '铁血魔域', 地图名字变量: '空', 怪物名字: '恶魔主将', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '铁血魔域', 地图名字变量: '空', 怪物名字: '恶魔教主', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '铁血魔域', 地图名字变量: '空', 怪物名字: '恶灵尸王', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '铁血魔域', 地图名字变量: '空', 怪物名字: '恶灵教主', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '铁血魔域', 地图名字变量: '铁血魔域', 怪物名字: '远古战神', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '血腥森林', 地图名字变量: '空', 怪物名字: '恶灵僵尸', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '血腥森林', 地图名字变量: '空', 怪物名字: '恶灵弓箭手', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '血腥森林', 地图名字变量: '空', 怪物名字: '骷髅锤兵', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '血腥森林', 地图名字变量: '空', 怪物名字: '骷髅长枪兵', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '血腥森林', 地图名字变量: '空', 怪物名字: '骷髅刀斧手', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '血腥森林', 地图名字变量: '空', 怪物名字: '骷髅弓箭手', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '血腥森林', 地图名字变量: '空', 怪物名字: '黄泉战神', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '血腥森林', 地图名字变量: '空', 怪物名字: '黄泉教主', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '血腥森林', 地图名字变量: '血腥森林', 怪物名字: '暗之黄泉教主', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '蛮荒丛林', 地图名字变量: '空', 怪物名字: '骷髅刀斧手', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '蛮荒丛林', 地图名字变量: '空', 怪物名字: '牛头魔', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '蛮荒丛林', 地图名字变量: '空', 怪物名字: '牛魔斗士', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '蛮荒丛林', 地图名字变量: '空', 怪物名字: '牛魔战士', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '蛮荒丛林', 地图名字变量: '空', 怪物名字: '牛魔侍卫', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '蛮荒丛林', 地图名字变量: '空', 怪物名字: '牛魔法师', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '蛮荒丛林', 地图名字变量: '空', 怪物名字: '牛魔将军', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '蛮荒丛林', 地图名字变量: '空', 怪物名字: '牛魔祭祀', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '蛮荒丛林', 地图名字变量: '蛮荒丛林', 怪物名字: '牛魔王', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '血狱皇陵', 地图名字变量: '空', 怪物名字: '牛魔斗士', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '血狱皇陵', 地图名字变量: '空', 怪物名字: '牛魔战士', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '血狱皇陵', 地图名字变量: '空', 怪物名字: '魔龙刀兵', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '血狱皇陵', 地图名字变量: '空', 怪物名字: '魔龙破甲兵', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '血狱皇陵', 地图名字变量: '空', 怪物名字: '魔龙射手', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '血狱皇陵', 地图名字变量: '空', 怪物名字: '魔龙战将', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '血狱皇陵', 地图名字变量: '空', 怪物名字: '魔龙巨蛾', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '血狱皇陵', 地图名字变量: '空', 怪物名字: '魔龙力士', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '血狱皇陵', 地图名字变量: '血狱皇陵', 怪物名字: '魔龙教主', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '星空廊道', 地图名字变量: '空', 怪物名字: '魔龙战将', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '星空廊道', 地图名字变量: '空', 怪物名字: '魔龙巨蛾', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '星空廊道', 地图名字变量: '空', 怪物名字: '黑牙蜘蛛', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '星空廊道', 地图名字变量: '空', 怪物名字: '狂热火蜥蜴', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '星空廊道', 地图名字变量: '空', 怪物名字: '烈焰骑士', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '星空廊道', 地图名字变量: '空', 怪物名字: '烈焰蜘蛛', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '星空廊道', 地图名字变量: '空', 怪物名字: '巨镰蜘蛛', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '星空廊道', 地图名字变量: '空', 怪物名字: '雷炎蛛王', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '星空廊道', 地图名字变量: '星空廊道', 怪物名字: '火龙神', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '黑暗森林', 地图名字变量: '空', 怪物名字: '黑牙蜘蛛', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '黑暗森林', 地图名字变量: '空', 怪物名字: '狂热火蜥蜴', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '黑暗森林', 地图名字变量: '空', 怪物名字: '硬壳海龟', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '黑暗森林', 地图名字变量: '空', 怪物名字: '胆小海螺', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '黑暗森林', 地图名字变量: '空', 怪物名字: '雷炎蛛王', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '黑暗森林', 地图名字变量: '空', 怪物名字: '暴怒三叶虫', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '黑暗森林', 地图名字变量: '空', 怪物名字: '深海星尾兽', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '黑暗森林', 地图名字变量: '空', 怪物名字: '海陆爬行怪', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '黑暗森林', 地图名字变量: '黑暗森林', 怪物名字: '海域九头怪', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '郊外平原', 地图名字变量: '空', 怪物名字: '硬壳海龟', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '郊外平原', 地图名字变量: '空', 怪物名字: '胆小海螺', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '郊外平原', 地图名字变量: '空', 怪物名字: '黑牙蜘蛛', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '郊外平原', 地图名字变量: '空', 怪物名字: '火龙神', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '郊外平原', 地图名字变量: '空', 怪物名字: '狂热火蜥蜴', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '郊外平原', 地图名字变量: '空', 怪物名字: '暴怒三叶虫', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '郊外平原', 地图名字变量: '空', 怪物名字: '深海星尾兽', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '郊外平原', 地图名字变量: '空', 怪物名字: '海陆爬行怪', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '郊外平原', 地图名字变量: '郊外平原', 怪物名字: '海域九头怪', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '天然洞穴', 地图名字变量: '空', 怪物名字: '黑牙蜘蛛', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '天然洞穴', 地图名字变量: '空', 怪物名字: '狂热火蜥蜴', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '天然洞穴', 地图名字变量: '空', 怪物名字: '海陆爬行怪', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '天然洞穴', 地图名字变量: '空', 怪物名字: '雪域侍卫', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '天然洞穴', 地图名字变量: '空', 怪物名字: '雪域羊人', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '天然洞穴', 地图名字变量: '空', 怪物名字: '雪域战将', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '天然洞穴', 地图名字变量: '空', 怪物名字: '雪域五毒魔', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '天然洞穴', 地图名字变量: '空', 怪物名字: '雪域巨兽', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '天然洞穴', 地图名字变量: '天然洞穴', 怪物名字: '雪域巨魔', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '矿区山谷', 地图名字变量: '空', 怪物名字: '雪域侍卫', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '矿区山谷', 地图名字变量: '空', 怪物名字: '雪域羊人', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '矿区山谷', 地图名字变量: '空', 怪物名字: '雪域战将', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '矿区山谷', 地图名字变量: '空', 怪物名字: '青狐', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '矿区山谷', 地图名字变量: '空', 怪物名字: '深狐', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '矿区山谷', 地图名字变量: '空', 怪物名字: '蝴蝶精', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '矿区山谷', 地图名字变量: '空', 怪物名字: '狐月长老', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '矿区山谷', 地图名字变量: '空', 怪物名字: '狐月精灵', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '矿区山谷', 地图名字变量: '矿区山谷', 怪物名字: '狐月仙子', 刷新时间: BOSS刷新, TAG: 15 },
    { 地图名字: '祖玛回廊', 地图名字变量: '空', 怪物名字: '雪域羊人', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '祖玛回廊', 地图名字变量: '空', 怪物名字: '雪域战将', 刷新时间: 小怪刷新, TAG: 11 },
    { 地图名字: '祖玛回廊', 地图名字变量: '空', 怪物名字: '雪域五毒魔', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '祖玛回廊', 地图名字变量: '空', 怪物名字: '雪域冰狼', 刷新时间: 小怪刷新, TAG: 12 },
    { 地图名字: '祖玛回廊', 地图名字变量: '空', 怪物名字: '雪域冰甲虫', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '祖玛回廊', 地图名字变量: '空', 怪物名字: '雪域冰魔', 刷新时间: 精英刷新, TAG: 13 },
    { 地图名字: '祖玛回廊', 地图名字变量: '空', 怪物名字: '雪域灭天魔', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '祖玛回廊', 地图名字变量: '空', 怪物名字: '雪域巨人', 刷新时间: 精英刷新, TAG: 14 },
    { 地图名字: '祖玛回廊', 地图名字变量: '祖玛回廊', 怪物名字: '雪域教主', 刷新时间: BOSS刷新, TAG: 15 },

{ 地图名字:	'万妖森林'	, 地图名字变量:	'空'	,怪物名字:	'龙邪蜘蛛'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'万妖森林'	, 地图名字变量:	'空'	,怪物名字:	'龙邪虎蛇'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'万妖森林'	, 地图名字变量:	'空'	,怪物名字:	'龙邪红蛇'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'万妖森林'	, 地图名字变量:	'空'	,怪物名字:	'龙邪蜥蜴'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'万妖森林'	, 地图名字变量:	'空'	,怪物名字:	'龙邪将军'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'万妖森林'	, 地图名字变量:	'空'	,怪物名字:	'龙邪教主'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'万妖森林'	, 地图名字变量:	'空'	,怪物名字:	'狐月长老'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'万妖森林'	, 地图名字变量:	'空'	,怪物名字:	'狐月精灵'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'万妖森林'	, 地图名字变量:	'万妖森林'	,怪物名字:	'狐月仙子'	,刷新时间:	BOSS刷新	, TAG:	15	},
{ 地图名字:	'万妖峡谷'	, 地图名字变量:	'空'	,怪物名字:	'魔龙刀兵'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'万妖峡谷'	, 地图名字变量:	'空'	,怪物名字:	'魔龙破甲兵'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'万妖峡谷'	, 地图名字变量:	'空'	,怪物名字:	'蜈蚣王'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'万妖峡谷'	, 地图名字变量:	'空'	,怪物名字:	'迅捷兽'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'万妖峡谷'	, 地图名字变量:	'空'	,怪物名字:	'领头羊'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'万妖峡谷'	, 地图名字变量:	'空'	,怪物名字:	'暗影巫师'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'万妖峡谷'	, 地图名字变量:	'空'	,怪物名字:	'暗黑女武士'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'万妖峡谷'	, 地图名字变量:	'空'	,怪物名字:	'奇美拉'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'万妖峡谷'	, 地图名字变量:	'万妖峡谷'	,怪物名字:	'安达利尔'	,刷新时间:	BOSS刷新	, TAG:	15	},
{ 地图名字:	'万妖之巢'	, 地图名字变量:	'空'	,怪物名字:	'雪蚕王'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'万妖之巢'	, 地图名字变量:	'空'	,怪物名字:	'蝎子王'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'万妖之巢'	, 地图名字变量:	'空'	,怪物名字:	'蜈蚣王'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'万妖之巢'	, 地图名字变量:	'空'	,怪物名字:	'地狱犬'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'万妖之巢'	, 地图名字变量:	'空'	,怪物名字:	'烈焰骑士'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'万妖之巢'	, 地图名字变量:	'空'	,怪物名字:	'烈焰蜘蛛'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'万妖之巢'	, 地图名字变量:	'空'	,怪物名字:	'炎龙神'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'万妖之巢'	, 地图名字变量:	'空'	,怪物名字:	'狂热火蜥蜴'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'万妖之巢'	, 地图名字变量:	'万妖之巢'	,怪物名字:	'鸡凤'	,刷新时间:	BOSS刷新	, TAG:	15	},
{ 地图名字:	'万妖迷宫'	, 地图名字变量:	'空'	,怪物名字:	'迅捷兽'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'万妖迷宫'	, 地图名字变量:	'空'	,怪物名字:	'领头羊'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'万妖迷宫'	, 地图名字变量:	'空'	,怪物名字:	'暗影巫师'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'万妖迷宫'	, 地图名字变量:	'空'	,怪物名字:	'暗黑女武士'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'万妖迷宫'	, 地图名字变量:	'空'	,怪物名字:	'狂暴棕熊'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'万妖迷宫'	, 地图名字变量:	'空'	,怪物名字:	'温顺棕熊'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'万妖迷宫'	, 地图名字变量:	'空'	,怪物名字:	'变异羊鸟'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'万妖迷宫'	, 地图名字变量:	'空'	,怪物名字:	'棕熊头领'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'万妖迷宫'	, 地图名字变量:	'万妖迷宫'	,怪物名字:	'恶魔金怪'	,刷新时间:	BOSS刷新	, TAG:	15	},
{ 地图名字:	'万妖祭坛'	, 地图名字变量:	'空'	,怪物名字:	'金杖蜘蛛'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'万妖祭坛'	, 地图名字变量:	'空'	,怪物名字:	'巨镰蜘蛛'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'万妖祭坛'	, 地图名字变量:	'空'	,怪物名字:	'黑牙蜘蛛'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'万妖祭坛'	, 地图名字变量:	'空'	,怪物名字:	'雷炎蛛王'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'万妖祭坛'	, 地图名字变量:	'空'	,怪物名字:	'龅牙野猪'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'万妖祭坛'	, 地图名字变量:	'空'	,怪物名字:	'青面羊兽'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'万妖祭坛'	, 地图名字变量:	'空'	,怪物名字:	'蜥蜴战士'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'万妖祭坛'	, 地图名字变量:	'空'	,怪物名字:	'恶鬼丧尸'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'万妖祭坛'	, 地图名字变量:	'万妖祭坛'	,怪物名字:	'三头兽'	,刷新时间:	BOSS刷新	, TAG:	15	},
{ 地图名字:	'邪恶洞穴'	, 地图名字变量:	'空'	,怪物名字:	'蝎子王'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'邪恶洞穴'	, 地图名字变量:	'空'	,怪物名字:	'蜈蚣王'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'邪恶洞穴'	, 地图名字变量:	'空'	,怪物名字:	'石原秃鹰'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'邪恶洞穴'	, 地图名字变量:	'空'	,怪物名字:	'石原战将'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'邪恶洞穴'	, 地图名字变量:	'空'	,怪物名字:	'石原魔人'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'邪恶洞穴'	, 地图名字变量:	'空'	,怪物名字:	'石原沙虫'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'邪恶洞穴'	, 地图名字变量:	'空'	,怪物名字:	'巨人石精'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'邪恶洞穴'	, 地图名字变量:	'空'	,怪物名字:	'死神'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'邪恶洞穴'	, 地图名字变量:	'邪恶洞穴'	,怪物名字:	'地狱使者'	,刷新时间:	BOSS刷新	, TAG:	15	},
{ 地图名字:	'蛇妖山谷'	, 地图名字变量:	'空'	,怪物名字:	'牛头魔'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'蛇妖山谷'	, 地图名字变量:	'空'	,怪物名字:	'牛魔斗士'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'蛇妖山谷'	, 地图名字变量:	'空'	,怪物名字:	'牛魔战士'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'蛇妖山谷'	, 地图名字变量:	'空'	,怪物名字:	'牛魔侍卫'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'蛇妖山谷'	, 地图名字变量:	'空'	,怪物名字:	'幽冥雕像'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'蛇妖山谷'	, 地图名字变量:	'空'	,怪物名字:	'幽冥卫士'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'蛇妖山谷'	, 地图名字变量:	'空'	,怪物名字:	'幽冥统领'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'蛇妖山谷'	, 地图名字变量:	'空'	,怪物名字:	'幽冥教主'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'蛇妖山谷'	, 地图名字变量:	'蛇妖山谷'	,怪物名字:	'幽魂'	,刷新时间:	BOSS刷新	, TAG:	15	},
{ 地图名字:	'沃玛寺庙'	, 地图名字变量:	'空'	,怪物名字:	'牛头魔'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'沃玛寺庙'	, 地图名字变量:	'空'	,怪物名字:	'牛魔斗士'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'沃玛寺庙'	, 地图名字变量:	'空'	,怪物名字:	'骷髅锤兵'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'沃玛寺庙'	, 地图名字变量:	'空'	,怪物名字:	'骷髅长枪兵'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'沃玛寺庙'	, 地图名字变量:	'空'	,怪物名字:	'骷髅刀斧手'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'沃玛寺庙'	, 地图名字变量:	'空'	,怪物名字:	'骷髅弓箭手'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'沃玛寺庙'	, 地图名字变量:	'空'	,怪物名字:	'玛法法神'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'沃玛寺庙'	, 地图名字变量:	'空'	,怪物名字:	'玛法妖神'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'沃玛寺庙'	, 地图名字变量:	'沃玛寺庙'	,怪物名字:	'人类之主'	,刷新时间:	BOSS刷新	, TAG:	15	},
{ 地图名字:	'暗黑蛇谷'	, 地图名字变量:	'空'	,怪物名字:	'骷髅锤兵'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'暗黑蛇谷'	, 地图名字变量:	'空'	,怪物名字:	'骷髅长枪兵'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'暗黑蛇谷'	, 地图名字变量:	'空'	,怪物名字:	'骷髅刀斧手'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'暗黑蛇谷'	, 地图名字变量:	'空'	,怪物名字:	'骷髅弓箭手'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'暗黑蛇谷'	, 地图名字变量:	'空'	,怪物名字:	'异变骷髅'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'暗黑蛇谷'	, 地图名字变量:	'空'	,怪物名字:	'先锋巨锤'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'暗黑蛇谷'	, 地图名字变量:	'空'	,怪物名字:	'骑士战神'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'暗黑蛇谷'	, 地图名字变量:	'空'	,怪物名字:	'异变蛛人'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'暗黑蛇谷'	, 地图名字变量:	'暗黑蛇谷'	,怪物名字:	'黄泉教王'	,刷新时间:	BOSS刷新	, TAG:	15	},
{ 地图名字:	'沉息之地'	, 地图名字变量:	'空'	,怪物名字:	'兽人长矛兵'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'沉息之地'	, 地图名字变量:	'空'	,怪物名字:	'兽人巡逻兵'	,刷新时间:	小怪刷新	, TAG:	11	},
{ 地图名字:	'沉息之地'	, 地图名字变量:	'空'	,怪物名字:	'兽人狂战士'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'沉息之地'	, 地图名字变量:	'空'	,怪物名字:	'兽人驯兽师'	,刷新时间:	小怪刷新	, TAG:	12	},
{ 地图名字:	'沉息之地'	, 地图名字变量:	'空'	,怪物名字:	'兽人巨魔'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'沉息之地'	, 地图名字变量:	'空'	,怪物名字:	'兽人骑兵'	,刷新时间:	精英刷新	, TAG:	13	},
{ 地图名字:	'沉息之地'	, 地图名字变量:	'空'	,怪物名字:	'恶魔主将'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'沉息之地'	, 地图名字变量:	'空'	,怪物名字:	'恶魔教主'	,刷新时间:	精英刷新	, TAG:	14	},
{ 地图名字:	'沉息之地'	, 地图名字变量:	'沉息之地'	,怪物名字:	'恶魔之主'	,刷新时间:	BOSS刷新	, TAG:	15	},



]

const 检测地图玩家数量 = [
    '荒芜山谷',
    '试炼之地',
    '血之炼狱',
    '竞技洞窟',
    '血路之颠',
    '沙漠绿洲',
    '凄凉之地',
    '狂风峭壁',
    '崎岖索道',
    '风暴峡谷',
    '古船遗迹',
    '森林迷宫',
    '古之城墙',
    '暗影迷宫',
    '失落暗殿',
    '神秘古国',
    '海岛遗迹',
    '魔之莽道',
    '盘蛇古迹',
    '泗水祭坛',
    '铁血魔域',
    '血腥森林',
    '蛮荒丛林',
    '血狱皇陵',
    '星空廊道',

    '黑暗森林',
    '郊外平原',
    '天然洞穴',
    '矿区山谷',
    '祖玛回廊',

    '万妖森林',
    '万妖峡谷',
    '万妖之巢',
    '万妖迷宫',
    '万妖祭坛',

    '邪恶洞穴',
    '蛇妖山谷',
    '沃玛寺庙',
    '暗黑蛇谷',
    '沉息之地',

    '神域冰谷',
    '纷争之地',
    '上古禁地',
    '封印之城',
    '神庙主殿',
]

class 刷怪配置 {
    地图名字: string = '';
    地图ID: string = '';
    地图名字变量: string = '';
    怪物名字: string = '';
    // 坐标X: number = 0;
    // 坐标Y: number = 0;
    // 范围: number = 0;
    数量: number = 0;
    刷新时间: number = 0;
    TAG: number = 0;

}
//================================================
// 清理过期缓存
function 清理过期缓存(): void {
    const 当前时间 = Date.now();
    const 过期键列表: string[] = [];
    
    for (const 键 in 缓存时间戳) {
        if ((当前时间 - 缓存时间戳[键]) >= 缓存过期时间) {
            过期键列表.push(键);
        }
    }
    
    for (const 键 of 过期键列表) {
        delete 地图缓存[键];
        delete 缓存时间戳[键];
    }
    
    if (调试模式 && 过期键列表.length > 0) {
        console.log(`[缓存清理] 清理了 ${过期键列表.length} 个过期缓存`);
    }
}

// 智能地图查找函数（带缓存）
function 智能查找地图(副本配置: any): TEnvirnoment | null {
    const 缓存键 = `${副本配置.地图ID}_${副本配置.地图名}`;
    const 当前时间 = Date.now();
    
    // 检查缓存是否有效
    if (地图缓存[缓存键] && 缓存时间戳[缓存键] && 
        (当前时间 - 缓存时间戳[缓存键]) < 缓存过期时间) {
        return 地图缓存[缓存键];
    }
    
    let AMap: TEnvirnoment | null = null;
    
    // 方法1：使用地图ID查找
    if (副本配置.地图ID) {
        AMap = GameLib.FindMap(副本配置.地图ID);
    }
    
    // 方法2：如果方法1失败，尝试使用显示名查找
    if (!AMap && 副本配置.显示名) {
        AMap = GameLib.FindMap(副本配置.显示名);
    }
    
    // 方法3：如果方法2也失败，尝试使用原始地图名查找
    if (!AMap && 副本配置.地图名) {
        AMap = GameLib.FindMap(副本配置.地图名);
    }
    
    // 更新缓存
    地图缓存[缓存键] = AMap;
    缓存时间戳[缓存键] = 当前时间;
    
    if (调试模式 && !AMap) {
        console.log(`[地图查找失败] 无法找到地图: ${副本配置.地图名} (ID: ${副本配置.地图ID})`);
    }
    
    return AMap;
}

// 安全获取地图人数
function 安全获取地图人数(AMap: TEnvirnoment): number {
    try {
        const 人数 = AMap.GetHumCount();
        return (人数 === undefined || 人数 === null) ? 0 : 人数;
    } catch (error) {
        if (调试模式) {
            console.log(`[人数获取失败] ${AMap.MapName || 'Unknown'} - ${error}`);
        }
        return 0;
    }
}

// 安全获取怪物数量
function 安全获取怪物数量(AMap: TEnvirnoment, 怪物名字: string): number {
    try {
        const 数量 = AMap.GetMonCountEx(怪物名字);
        return (数量 === undefined || 数量 === null) ? 0 : 数量;
    } catch (error) {
        if (调试模式) {
            console.log(`[怪物数量获取失败] ${AMap.MapName || 'Unknown'} - ${怪物名字} - ${error}`);
        }
        return 0;
    }
}

// 计算基于地图面积的刷怪数量分配
function 计算刷怪数量分配(AMap: TEnvirnoment, 当前刷怪配置: any[], 循环: any): number {
    // 计算地图面积
    const 地图宽度 = AMap.GetMapWidth();
    const 地图高度 = AMap.GetMapHeight();
    const 地图面积 = 地图宽度 * 地图高度;

    const 地图星级 = 地图.地图ID取固定星级(AMap.MapID)
    // 总数量为地图面积的5%，但限制在500-1800范围内
    // 1. 计算基础值（地图面积 * 0.05 向下取整）
    const 基础数量 = Math.floor(地图面积 * 0.05);

    // 2. 定义默认范围配置（优先级：默认 < 包区 < 地图星级）
    const 默认数量 = { min: 300, max: 1000 };

    // 3. 根据条件覆盖配置（按优先级从低到高处理）
    let config = { ...默认数量 };


    // 根据地图星级调整范围（星级条件优先级高于包区）
    switch (地图星级) {
        case 5:  config = { min: 300, max: 800 };break;
        case 45: config = { min: 300, max: 500 };  break;
        case 20: config = { min: 200, max: 600 };  break;
        case 22: config = { min: 200, max: 900 };  break;
        case 23: config = { min: 200, max: 800 };  break;
        case 26: config = { min: 200, max: 1200 };  break;
        case 31: config = { min: 200, max: 2500 };  break;

        default:
            // 星级≤3时的配置（优先级：高于包区，低于特定星级）
            if (地图星级 <= 3) {
                config = { min: 300, max: 1400 };
            }
    }

    // 4. 计算最终总数量
    let 总数量 = Math.min(config.max, Math.max(config.min, 基础数量));

    // 如果是包区服务器，调整范围
    if (GameLib.ServerName.includes('包区')) {
        总数量 = 总数量 * 1.5;
    }


    // console.log(`总数量: ${总数量} 基础数量: ${基础数量} 地图星级: ${地图星级} ,地图ID: ${AMap.MapID} ,星级: ${星级}`)


    // 根据TAG尾数分配数量
    const TAG尾数 = 循环.TAG % 10;
    let 分配数量 = 0;

    // 定义各尾数的分配比例
    const 分配比例 = {
        1: 0.4,  // 40%
        2: 0.3,  // 20%
        3: 0.15, // 15%
        4: 0.1,  // 10%
        5: 0.05  // 5%
    };

    if (分配比例[TAG尾数]) {
        // 有明确比例的尾数
        分配数量 = Math.floor(总数量 * 分配比例[TAG尾数]);
        const 同尾数怪物数量 = 当前刷怪配置.filter(配置 => 配置.TAG % 10 === TAG尾数).length;
        if (同尾数怪物数量 > 1) {
            分配数量 = Math.floor(分配数量 / 同尾数怪物数量);
        }
    } else {
        // 其他尾数随机分配剩余10%
        const 其他尾数怪物数量 = 当前刷怪配置.filter(配置 => !分配比例[配置.TAG % 10]).length;
        if (其他尾数怪物数量 > 0) {
            分配数量 = Math.floor(总数量 * 0.12 / 其他尾数怪物数量);
        }
    }

    // 确保分配数量至少为1
    return Math.max(10, 分配数量);
}

// 获取地图智能刷怪参数
function 获取地图刷怪参数(AMap: TEnvirnoment): { 智能坐标X: number, 智能坐标Y: number, 智能范围: number } {
    const 智能坐标X = AMap.GetMapWidth() / 2;
    const 智能坐标Y = AMap.GetMapHeight() / 2;
    const 智能范围 = AMap.GetMapWidth() > AMap.GetMapHeight() ?
        AMap.GetMapWidth() / 2 : AMap.GetMapHeight() / 2;

    return { 智能坐标X, 智能坐标Y, 智能范围 };
}

export function 秒钟第一次进入刷怪(): void {
    Randomize();

    // 遍历所有在线玩家
    for (let i = 0; i < GameLib.PlayCount; i++) {
        const Player = GameLib.GetPlayer(i);
        if (!Player || !Player.Map) continue;

        // 获取当前地图ID
        const 当前地图ID = Player.Map.MapID;

        // 检查是否已刷过该地图
        if (GameLib.R[当前地图ID] === true) continue;

        let 副本池 = 地图.取地图;
        // 获取当前地图ID对应的副本配置
        const 当前副本配置 = 副本池().find(item => item.地图ID === 当前地图ID);
        if (!当前副本配置) continue;

        // 根据副本配置中的地图名找到对应的刷怪配置
        const 当前刷怪配置 = 智能刷怪.filter(配置 => 配置.地图名字 === 当前副本配置.地图名);
        if (当前刷怪配置.length === 0) continue;

        for (let 循环 of 当前刷怪配置) {
            // 改进地图查找 - 多种方式尝试
            let AMap: TEnvirnoment | null = null;
            
            // 优先使用玩家当前所在地图
            if (Player.Map.MapName) {
                AMap = GameLib.FindMap(Player.Map.MapName);
            }
            
            // 如果失败，使用副本配置查找
            if (!AMap) {
                AMap = 智能查找地图(当前副本配置);
            }
            
            if (!AMap || GameLib.R[当前地图ID] === true) continue;

            // 安全检查地图人数
            const 地图人数 = 安全获取地图人数(AMap);
            if (地图人数 <= 0) continue;

            try {
                GameLib.R[当前地图ID] ??= false;
                const { 智能坐标X, 智能坐标Y, 智能范围 } = 获取地图刷怪参数(AMap);

                // 计算分配数量
                const 分配数量 = 计算刷怪数量分配(AMap, 当前刷怪配置, 循环);

                // 执行刷怪 - 使用更安全的地图名
                const 实际地图名 = AMap.MapName || Player.Map.MapName;
                
                // 检查是否是调试目标地图
                const 是首次调试目标 = 当前副本配置.下标 >= 47 && 当前副本配置.下标 <= 50;
                if (调试模式 && 是首次调试目标) {
                    console.log(`[首次刷怪-${当前副本配置.下标}] ${当前副本配置.地图名} - ${循环.怪物名字} x${分配数量} (人数: ${地图人数}, 地图: ${实际地图名})`);
                }
                
                GameLib.MonGen(实际地图名, 循环.怪物名字, 分配数量, 智能坐标X, 智能坐标Y, 智能范围, 0, 0, 循环.TAG, true, true, true, true);

                // 标记地图已刷怪
                if (循环.地图名字变量 === 循环.地图名字) {
                    GameLib.R[当前地图ID] = true;
                }
                
            } catch (error) {
                console.log(`[首次刷怪错误] ${当前副本配置.地图名} - ${循环.怪物名字} - ${error}`);
            }
        }
    }
}

export function 按分钟检测(Player: TPlayObject): void {
    Randomize();

    // 定期清理过期缓存
    清理过期缓存();

    // 获取副本池
    let 副本池 = 地图.取地图();
    
    if (调试模式) {
        console.log(`[刷怪调试] 开始按分钟检测，副本池数量: ${副本池.length}，调试目标: 下标47-50`);
    }
    
    // 遍历副本池里的所有地图
    for (const 副本配置 of 副本池) {
        // 跳过无效的副本配置
        if (!副本配置 || !副本配置.地图ID || !副本配置.地图名) {
            continue;
        }
        
        // 调试模式：只输出下标51-60的地图调试信息
        const 是调试目标地图 = 副本配置.下标 >= 47 && 副本配置.下标 <= 50;
        
        // 根据副本配置中的地图名找到对应的刷怪配置 - 改进匹配逻辑
        let 当前刷怪配置 = 智能刷怪.filter(配置 => 配置.地图名字 === 副本配置.地图名);
        
        // 如果直接匹配失败，尝试使用显示名提取原始地图名
        if (当前刷怪配置.length === 0 && 副本配置.显示名) {
            // 从显示名中提取原始地图名（去掉星级信息）
            const 原始地图名 = 副本配置.显示名.replace(/\(\d+星\)$/, '');
            当前刷怪配置 = 智能刷怪.filter(配置 => 配置.地图名字 === 原始地图名);
            
            if (调试模式 && 是调试目标地图 && 当前刷怪配置.length > 0) {
                console.log(`[刷怪调试-${副本配置.下标}] 通过显示名匹配成功: "${副本配置.显示名}" -> "${原始地图名}"`);
            }
        }
        
        if (当前刷怪配置.length === 0) {
            if (调试模式 && 是调试目标地图) {
                console.log(`[刷怪调试-${副本配置.下标}] 未找到刷怪配置: 副本地图名="${副本配置.地图名}", 显示名="${副本配置.显示名}", 副本ID="${副本配置.地图ID}"`);
                console.log(`[刷怪调试-${副本配置.下标}] 可用的刷怪地图名: ${智能刷怪.map(x => x.地图名字).filter((v, i, a) => a.indexOf(v) === i).join(', ')}`);
            }
            continue;
        }

        // 使用智能地图查找功能
        const AMap = 智能查找地图(副本配置);
        if (!AMap) {
            if (调试模式 && 是调试目标地图) {
                console.log(`[刷怪调试-${副本配置.下标}] 地图查找失败: ${副本配置.地图名} (ID: ${副本配置.地图ID})`);
            }
            continue;
        }

        // 使用安全的人数获取功能
        const 地图人数 = 安全获取地图人数(AMap);
        
        if (调试模式 && 是调试目标地图) {
            console.log(`[刷怪调试-${副本配置.下标}] 地图 ${副本配置.地图名} (ID: ${副本配置.地图ID}) - 人数: ${地图人数}, 实际地图名: ${AMap.MapName}`);
        }

        // 如果地图没有人，跳过刷怪
        if (地图人数 <= 0) {
            if (调试模式 && 是调试目标地图) {
                console.log(`[刷怪调试-${副本配置.下标}] 地图 ${副本配置.地图名} 无人，跳过刷怪`);
            }
            continue;
        }

        // 确保地图已初始化刷怪状态 - 使用多个状态键进行验证
        const 地图状态键 = 副本配置.地图ID;
        const 备用状态键 = `${副本配置.地图名}_${副本配置.地图ID}_state`;
        
        // 检查地图是否被重新创建（ID可能变化）
        if (GameLib.R[地图状态键] === undefined) {
            GameLib.R[地图状态键] = false;
            if (调试模式 && 是调试目标地图) {
                console.log(`[刷怪调试-${副本配置.下标}] 初始化地图状态: ${副本配置.地图名} (${地图状态键})`);
            }
        }
        
        // 双重验证 - 如果地图人数>0但状态还是false，可能需要重新检查
        if (地图人数 > 0 && GameLib.R[地图状态键] === true) {
            // 检查地图上是否真的有怪物，如果没有则重置状态
            let 总怪物数 = 0;
            for (let 检查配置 of 当前刷怪配置) {
                总怪物数 += 安全获取怪物数量(AMap, 检查配置.怪物名字);
            }
            
            if (总怪物数 === 0) {
                GameLib.R[地图状态键] = false;
                if (调试模式 && 是调试目标地图) {
                    console.log(`[刷怪调试-${副本配置.下标}] 检测到地图无怪物，重置状态: ${副本配置.地图名}`);
                }
            }
        }

        if (调试模式 && 是调试目标地图) {
            console.log(`[刷怪调试-${副本配置.下标}] 地图 ${副本配置.地图名} 当前刷怪状态: ${GameLib.R[地图状态键]}`);
        }


        // 如果地图还没有刷过怪，先进行初始刷怪
        if (GameLib.R[地图状态键] === false) {
            if (调试模式 && 是调试目标地图) {
                console.log(`[刷怪调试-${副本配置.下标}] 执行初始刷怪: ${副本配置.地图名}`);
            }
            try {
                const { 智能坐标X, 智能坐标Y, 智能范围 } = 获取地图刷怪参数(AMap);

                for (let 循环 of 当前刷怪配置) {
                    // 计算分配数量
                    const 分配数量 = 计算刷怪数量分配(AMap, 当前刷怪配置, 循环);

                    // 执行初始刷怪 - 使用实际地图名称
                    const 实际地图名 = AMap.MapName || 副本配置.地图ID;
                    GameLib.MonGen(实际地图名, 循环.怪物名字, 分配数量, 智能坐标X, 智能坐标Y, 智能范围, 0, 0, 循环.TAG, true, true, true, true);

                    // 只有BOSS怪物才标记地图已刷怪（参照原逻辑）
                    if (循环.地图名字变量 === 循环.地图名字) {
                        GameLib.R[地图状态键] = true;
                    }
                }
                if (调试模式 && 是调试目标地图) {
                    console.log(`[刷怪调试-${副本配置.下标}] 初始刷怪完成: ${副本配置.地图名} (人数: ${地图人数})`);
                }
            } catch (error) {
                console.log(`[刷怪错误] 初始刷怪失败: ${副本配置.地图名} - ${error}`);
            }
            continue;
        }

        // 地图已刷过怪，进行补怪检测
        if (调试模式 && 是调试目标地图) {
            console.log(`[刷怪调试-${副本配置.下标}] 开始补怪检测: ${副本配置.地图名}, 配置数量: ${当前刷怪配置.length}`);
            
            // 检查时间键冲突
            const 时间键集合 = new Set<string>();
            for (let 检查循环 of 当前刷怪配置) {
                const 检查时间键 = `${副本配置.地图ID}_${检查循环.怪物名字}_${检查循环.TAG}_time`;
                if (时间键集合.has(检查时间键)) {
                    console.log(`[刷怪警告-${副本配置.下标}] 发现重复时间键: "${检查时间键}"`);
                } else {
                    时间键集合.add(检查时间键);
                }
            }
        }
        
        for (let 循环 of 当前刷怪配置) {
            try {
                const { 智能坐标X, 智能坐标Y, 智能范围 } = 获取地图刷怪参数(AMap);

                // 改进时间键生成，包含地图ID避免冲突
                const 时间键 = `${副本配置.地图ID}_${循环.怪物名字}_${循环.TAG}_time`;
                GameLib.R[时间键] ??= 0;
                const 时间增量 = GameLib.V.判断新区 ? 1 : 2;
                
                // 记录增量前的值，用于调试
                const 增量前值 = GameLib.R[时间键];
                GameLib.R[时间键] += 时间增量;
                const 增量后值 = GameLib.R[时间键];
                
                // 检查副本是否被重置（地图状态变化）
                const 上次地图状态键 = `${副本配置.地图ID}_last_state`;
                const 当前地图状态 = GameLib.R[地图状态键];
                const 上次地图状态 = GameLib.R[上次地图状态键];
                
                if (上次地图状态 !== undefined && 上次地图状态 !== 当前地图状态) {
                    if (调试模式 && 是调试目标地图) {
                        console.log(`[刷怪调试-${副本配置.下标}] 检测到地图状态变化，重置时间: ${循环.怪物名字}`);
                    }
                    GameLib.R[时间键] = 0;
                }
                GameLib.R[上次地图状态键] = 当前地图状态;

                if (调试模式 && 是调试目标地图) {
                    console.log(`[刷怪调试-${副本配置.下标}] 怪物 ${循环.怪物名字} - 时间变化: ${增量前值} -> ${增量后值} (增量${时间增量}) 目标${循环.刷新时间}`);
                    console.log(`[刷怪调试-${副本配置.下标}] 时间键: "${时间键}", TAG: ${循环.TAG}, 新区: ${GameLib.V.判断新区}`);
                }
                
                // 额外检查：如果时间计数超过了刷新时间很多，说明可能有时间重置问题
                if (GameLib.R[时间键] > 循环.刷新时间 + 5 && 调试模式 && 是调试目标地图) {
                    console.log(`[刷怪警告-${副本配置.下标}] 怪物 ${循环.怪物名字} 时间计数异常过高: ${GameLib.R[时间键]}, 强制重置`);
                    GameLib.R[时间键] = 循环.刷新时间; // 强制重置到刷新时间
                }
                
                // 强制修复卡住的时间计数 - 如果连续多次检测都是相同值，强制推进
                const 上次时间键 = `${时间键}_last`;
                const 上次时间值 = GameLib.R[上次时间键];
                const 相同计数键 = `${时间键}_same_count`;
                
                if (上次时间值 === GameLib.R[时间键]) {
                    GameLib.R[相同计数键] = (GameLib.R[相同计数键] || 0) + 1;
                    if (GameLib.R[相同计数键] >= 3 && 调试模式 && 是调试目标地图) {
                        console.log(`[刷怪修复-${副本配置.下标}] 怪物 ${循环.怪物名字} 时间计数卡住，强制推进到刷新时间`);
                        GameLib.R[时间键] = 循环.刷新时间;
                        GameLib.R[相同计数键] = 0;
                    }
                } else {
                    GameLib.R[相同计数键] = 0;
                }
                
                GameLib.R[上次时间键] = GameLib.R[时间键];

                // 检查是否需要刷怪（时间到达 或 强制检查无怪物）
                const 当前怪物数量 = 安全获取怪物数量(AMap, 循环.怪物名字);
                const 应有数量 = 计算刷怪数量分配(AMap, 当前刷怪配置, 循环);
                const 需要强制补怪 = 当前怪物数量 === 0 && 应有数量 > 0;
                
                if (GameLib.R[时间键] >= 循环.刷新时间 || 需要强制补怪) {
                    if (调试模式 && 是调试目标地图) {
                        if (需要强制补怪) {
                            console.log(`[刷怪调试-${副本配置.下标}] 强制补怪触发: ${循环.怪物名字} (当前0只，应有${应有数量}只)`);
                        } else {
                            console.log(`[刷怪调试-${副本配置.下标}] 时间到达，开始检查怪物数量: ${循环.怪物名字}`);
                        }
                    }

                    // 计算分配数量
                    const 分配数量 = 计算刷怪数量分配(AMap, 当前刷怪配置, 循环);

                    // 使用已经获取的当前怪物数量
                    const 当前数量 = 当前怪物数量;
                    
                    const 补足数量 = 分配数量 - 当前数量;

                    if (调试模式 && 是调试目标地图) {
                        console.log(`[刷怪调试-${副本配置.下标}] 怪物数量检查: ${循环.怪物名字} - 当前: ${当前数量}, 应有: ${分配数量}, 需补: ${补足数量}`);
                    }

                    // 只有当需要补充时才刷怪
                    if (补足数量 > 0) {
                        const 实际地图名 = AMap.MapName || 副本配置.地图ID;
                        if (调试模式 && 是调试目标地图) {
                            console.log(`[刷怪调试-${副本配置.下标}] 执行补怪: ${循环.怪物名字} x${补足数量} 在地图 ${实际地图名} (坐标: ${智能坐标X},${智能坐标Y}, 范围: ${智能范围})`);
                        }
                        GameLib.MonGen(实际地图名, 循环.怪物名字, 补足数量, 智能坐标X, 智能坐标Y, 智能范围, 0, 0, 循环.TAG, true, true, true, true);
                    } else if (调试模式 && 是调试目标地图) {
                        console.log(`[刷怪调试-${副本配置.下标}] 无需补怪: ${循环.怪物名字}`);
                    }
                    
                    // 修复时间重置逻辑 - 无论是否强制补怪，只要执行了检查就重置时间
                    GameLib.R[时间键] = 0;
                    
                    if (调试模式 && 是调试目标地图) {
                        console.log(`[刷怪调试-${副本配置.下标}] 重置时间计数: ${循环.怪物名字} (强制补怪: ${需要强制补怪})`);
                    }
                }
            } catch (error) {
                console.log(`[刷怪错误] 补怪检测失败: ${副本配置.地图名} - ${循环.怪物名字} - ${error}`);
            }
        }
    }
}




export function 分钟检测无人60分清理怪物(): void {
    Randomize()
    let AMap: TEnvirnoment
    let 地图池 = 地图.取地图

    for (let a = 0; a < 地图池.length; a++) {
        AMap = GameLib.FindMap(地图池[a]);
        GameLib.R[地图池[a] + '检测清理'] ??= 0
        const 地图人数 = 安全获取地图人数(AMap);
        if (地图人数 < 1 && GameLib.R[地图池[a] + '检测清理'] < 60) {
            GameLib.R[地图池[a] + '检测清理']++
            // console.log(AMap.DisplayName + ' 地图无人：时间='+GameLib.R[地图池[a] + '检测清理'])
            if (GameLib.R[地图池[a] + '检测清理'] >= 3) {
                //  console.log('到达时间清理='+AMap.GetName())
                GameLib.ClearMapMon(AMap.GetName())
                GameLib.R[地图池[a]] = false
                // console.log('清除地图：' + AMap.DisplayName + `地图名字: ${地图池[a].显示名}`)
            }
        } else if (地图人数 > 0) {
            GameLib.R[地图池[a] + '检测清理'] = 0
        }
    }
    console.log('清除地图：' + AMap + `地图名字: ${地图池.length}`)
}